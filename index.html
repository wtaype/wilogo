<!DOCTYPE html>
<html lang='es' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
<head>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='width=device-width, initial-scale=1' name='viewport'/>
<meta content='blogger' name='generator'/>
<meta content='website' property='og:type'/>
<meta content='Wiloogo - Create best logos fast' property='og:title'/>
<meta content='https://wiloogo.blogspot.com/' property='og:url'/>
<meta content='index' property='og:pageType'/>
<meta content='Wiloogo es una plataforma eficiente con interfaz moderna y facil de usar para la creación de logos profesionales y bonitos.' name='description'/>
<link href='https://wiloogo.blogspot.com/feeds/posts/default?alt=rss' rel='alternate' title='Wiloogo - Create best logos fast - RSS' type='application/rss+xml'/>
<link href='https://www.blogger.com/feeds/7820185778302487206/posts/default' rel='service.post' title='Wiloogo - Create best logos fast - Atom' type='application/atom+xml'/>
<link href='https://wiloogo.blogspot.com/' rel='canonical'/>
<link href='https://wiloogo.blogspot.com/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='https://wiloogo.blogspot.com/favicon.ico' rel='icon' sizes='192x192'/>
<link href='https://wiloogo.blogspot.com/favicon.ico' rel='apple-touch-icon'/>
<title>Wiloogo - Create best logos fast</title>
<style id='page-skin-1' type='text/css'><!--
:root{--primary-bg:linear-gradient(135deg,#7fb2f0,#4a8fe7);--glass-bg:rgba(255,255,255,0.25);--glass-border:1px solid rgba(255,255,255,0.18);--glass-shadow:0 8px 32px 0 rgba(31,38,135,0.37);--text-color:#1a365d;--accent-color:#1978d7;--panel-radius:12px;--danger-color:#e74c3c;--success-color:#2ecc71;--warning-color:#f39c12;}*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;}body{background:var(--primary-bg);color:var(--text-color);min-height:100vh;padding:20px;overflow-x:hidden;}.glass-panel{background:var(--glass-bg);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);border-radius:var(--panel-radius);border:var(--glass-border);box-shadow:var(--glass-shadow);padding:20px;transition:all 0.3s ease;}.glass-panel:hover{box-shadow:0 10px 40px 0 rgba(31,38,135,0.45);}.container{max-width:1400px;margin:0 auto;display:grid;grid-template-columns:320px 1fr;grid-gap:20px;}header{grid-column:1 / -1;display:flex;justify-content:space-between;align-items:center;padding:15px 25px;margin-bottom:20px;}header h1{font-size:28px;color:white;text-shadow:0 2px 4px rgba(0,0,0,0.2);display:flex;align-items:center;gap:10px;}header h1 i{font-size:24px;}.toolbar{display:flex;gap:10px;}.btn{background:var(--glass-bg);border:var(--glass-border);border-radius:6px;padding:8px 15px;color:var(--text-color);cursor:pointer;display:flex;align-items:center;gap:5px;transition:all 0.2s;font-size:14px;}.btn:hover{background:rgba(255,255,255,0.4);}.btn.active{background-color:rgba(25,120,215,0.3);box-shadow:inset 0 0 5px rgba(0,0,0,0.1);}.btn-primary{background:var(--accent-color);color:white;}.btn-primary:hover{background:#1565c0;}.btn-success{background:var(--success-color);color:white;}.btn-success:hover{background:#27ae60;}.btn-danger{background:var(--danger-color);color:white;}.btn-danger:hover{background:#c0392b;}.sidebar{display:flex;flex-direction:column;gap:20px;max-height:calc(100vh - 140px);overflow-y:auto;padding-right:5px;}.sidebar::-webkit-scrollbar{width:6px;}.sidebar::-webkit-scrollbar-track{background:rgba(255,255,255,0.1);border-radius:10px;}.sidebar::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.3);border-radius:10px;}.panel-title{font-size:16px;font-weight:600;margin-bottom:15px;color:var(--text-color);display:flex;align-items:center;gap:8px;}.canvas-container{position:relative;height:70vh;overflow:hidden;display:flex;justify-content:center;align-items:center;border-radius:8px;}.canvas-bg{position:absolute;width:100%;height:100%;background-image:linear-gradient(45deg,#f0f0f0 25%,transparent 25%),linear-gradient(-45deg,#f0f0f0 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#f0f0f0 75%),linear-gradient(-45deg,transparent 75%,#f0f0f0 75%);background-size:20px 20px;background-position:0 0,0 10px,10px -10px,-10px 0;z-index:0;}.canvas-bg.grid-visible{background-image:linear-gradient(to right,rgba(25,120,215,0.1) 1px,transparent 1px),linear-gradient(to bottom,rgba(25,120,215,0.1) 1px,transparent 1px);background-size:20px 20px;background-position:0 0;}#logo-canvas{position:relative;width:400px;height:400px;z-index:1;background:transparent;}.resize-handle{position:absolute;width:10px;height:10px;background:var(--accent-color);border-radius:50%;z-index:100;}.resize-handle.top-left{top:-5px;left:-5px;cursor:nwse-resize;}.resize-handle.top-right{top:-5px;right:-5px;cursor:nesw-resize;}.resize-handle.bottom-left{bottom:-5px;left:-5px;cursor:nesw-resize;}.resize-handle.bottom-right{bottom:-5px;right:-5px;cursor:nwse-resize;}.form-group{margin-bottom:15px;}.form-group label{display:block;margin-bottom:5px;font-size:14px;}.form-control{width:100%;padding:8px 12px;border-radius:6px;border:1px solid rgba(255,255,255,0.3);background:rgba(255,255,255,0.2);color:var(--text-color);transition:all 0.2s;}.form-control:focus{outline:none;border-color:var(--accent-color);box-shadow:0 0 0 2px rgba(25,120,215,0.2);}.form-row{display:flex;gap:10px;}.form-row .form-group{flex:1;}.color-picker{display:flex;gap:5px;flex-wrap:wrap;margin-top:5px;}.color-option{width:25px;height:25px;border-radius:4px;cursor:pointer;border:1px solid rgba(255,255,255,0.5);transition:transform 0.2s;}.color-option:hover{transform:scale(1.1);}.gradient-preview{height:30px;border-radius:6px;margin-top:5px;background:linear-gradient(to right,#1978d7,#27ae60);}.templates-container{display:grid;grid-template-columns:1fr 1fr;gap:10px;}.template-item{border-radius:6px;overflow:hidden;cursor:pointer;border:2px solid transparent;transition:all 0.2s;position:relative;}.template-item:hover{border-color:var(--accent-color);transform:translateY(-2px);}.template-item img{width:100%;height:auto;display:block;}.template-item .template-name{position:absolute;bottom:0;left:0;right:0;background:rgba(0,0,0,0.6);color:white;padding:4px 8px;font-size:12px;text-align:center;}.shapes-container{display:flex;flex-wrap:wrap;gap:10px;}.shape-item{width:40px;height:40px;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.3);border-radius:6px;cursor:pointer;transition:all 0.2s;}.shape-item:hover{background:rgba(255,255,255,0.5);transform:translateY(-2px);}.shape-item.active{background:rgba(25,120,215,0.3);box-shadow:0 0 0 2px var(--accent-color);}.layers-panel{max-height:200px;overflow-y:auto;}.layer-item{display:flex;align-items:center;justify-content:space-between;padding:8px;border-radius:4px;margin-bottom:5px;background:rgba(255,255,255,0.1);cursor:pointer;transition:all 0.2s;}.layer-item:hover{background:rgba(255,255,255,0.2);}.layer-item.active{background:rgba(25,120,215,0.2);}.layer-item i{margin-right:8px;}.layer-controls{display:flex;gap:5px;}.layer-controls i{cursor:pointer;opacity:0.7;transition:all 0.2s;}.layer-controls i:hover{opacity:1;}.export-options{display:grid;grid-template-columns:1fr 1fr;gap:10px;}.tabs{display:flex;border-bottom:1px solid rgba(255,255,255,0.2);margin-bottom:15px;}.tab{padding:8px 15px;cursor:pointer;opacity:0.7;transition:all 0.2s;}.tab:hover{opacity:0.9;}.tab.active{opacity:1;border-bottom:2px solid var(--accent-color);}.tab-content{display:none;}.tab-content.active{display:block;}.preview-backgrounds{display:flex;gap:10px;margin-top:10px;}.preview-bg-option{width:40px;height:40px;border-radius:4px;cursor:pointer;border:1px solid rgba(255,255,255,0.5);overflow:hidden;}.preview-bg-option.white{background:white;}.preview-bg-option.black{background:black;}.preview-bg-option.pattern{background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:10px 10px;}.preview-bg-option.gradient{background:linear-gradient(45deg,#f3f3f3,#e1e1e1);}.image-upload-area{border:2px dashed rgba(255,255,255,0.5);border-radius:6px;padding:20px;text-align:center;margin-bottom:15px;cursor:pointer;transition:all 0.2s;}.image-upload-area:hover{border-color:var(--accent-color);background:rgba(255,255,255,0.1);}.image-upload-area i{font-size:24px;margin-bottom:10px;color:rgba(255,255,255,0.7);}.image-upload-area p{font-size:14px;color:rgba(0,0,0,0.7);}.dimensions-controls{display:flex;align-items:center;gap:10px;}.dimensions-controls input{width:70px;}.dimensions-controls select{width:60px;}.tooltip{position:relative;display:inline-block;}.tooltip .tooltip-text{visibility:hidden;width:200px;background-color:rgba(0,0,0,0.8);color:#fff;text-align:center;border-radius:6px;padding:5px;position:absolute;z-index:1;bottom:125%;left:50%;transform:translateX(-50%);opacity:0;transition:opacity 0.3s;font-size:12px;}.tooltip:hover .tooltip-text{visibility:visible;opacity:1;}.history-thumbnails{display:flex;gap:5px;overflow-x:auto;padding:5px 0;margin-top:10px;}.history-thumbnail{width:60px;height:60px;border-radius:4px;border:2px solid transparent;cursor:pointer;overflow:hidden;}.history-thumbnail.active{border-color:var(--accent-color);}.history-thumbnail img{width:100%;height:100%;object-fit:cover;}.alignment-tools{display:flex;gap:5px;margin-top:10px;}.alignment-tool{width:30px;height:30px;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.2);border-radius:4px;cursor:pointer;}.alignment-tool:hover{background:rgba(255,255,255,0.3);}.effects-panel{margin-top:15px;}.effect-option{display:flex;align-items:center;margin-bottom:8px;}.effect-option label{margin-left:8px;margin-bottom:0;}.preview-modal{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.8);z-index:1000;justify-content:center;align-items:center;flex-direction:column;}.preview-modal-content{background:white;padding:20px;border-radius:10px;max-width:80%;max-height:80%;overflow:auto;position:relative;}.preview-modal-close{position:absolute;top:10px;right:10px;font-size:24px;cursor:pointer;color:#333;}.preview-device-options{display:flex;gap:10px;margin-top:20px;}.preview-device{padding:5px 10px;background:rgba(255,255,255,0.2);border-radius:4px;cursor:pointer;}.preview-device.active{background:var(--accent-color);color:white;}@media (max-width:768px){.container{grid-template-columns:1fr;}.sidebar{order:2;}.canvas-container{height:50vh;}}

--></style>
<link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css' rel='stylesheet'/>
<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js'></script>
<script src='https://html2canvas.hertzen.com/dist/html2canvas.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/svg.js/3.1.1/svg.min.js'></script>
<meta name='google-adsense-platform-account' content='ca-host-pub-1556223355139109'/>
<meta name='google-adsense-platform-domain' content='blogspot.com'/>

</head>
<body>
<!--DIOS ES BUENO[START V10.6 7820185778302487206]-->
<div class='container'>
<header class='glass-panel'>
<h1>
<i class='fas fa-paint-brush'>
</i> Creador de Logos Wil!</h1>
<div class='toolbar'>
<button class='btn' id='btn-undo' title='Deshacer (Ctrl+Z)'>
<i class='fas fa-undo'>
</i>
</button>
<button class='btn' id='btn-redo' title='Rehacer (Ctrl+Y)'>
<i class='fas fa-redo'>
</i>
</button>
<button class='btn' id='btn-grid' title='Mostrar/ocultar cuadrícula (Ctrl+G)'>
<i class='fas fa-th'>
</i>
</button>
<button class='btn btn-primary' id='btn-preview' title='Vista previa'>
<i class='fas fa-eye'>
</i> Vista previa</button>
</div>
</header>
<aside class='sidebar'>
<section class='glass-panel' id='text-panel'>
<h3 class='panel-title'>
<i class='fas fa-font'>
</i> Texto</h3>
<div class='form-group'>
<label for='logo-text'>Texto del logo</label>
<input class='form-control' id='logo-text' type='text' value='WS'/>
</div>
<div class='form-group'>
<label for='font-family'>Fuente</label>
<select class='form-control' id='font-family'>
<option value='Arial Black'>Arial Black</option>
<option value='Helvetica'>Helvetica</option>
<option value='Montserrat'>Montserrat</option>
<option value='Roboto'>Roboto</option>
<option value='Poppins'>Poppins</option>
<option value='Open Sans'>Open Sans</option>
</select>
</div>
<div class='form-row'>
<div class='form-group'>
<label for='font-size'>Tamaño</label>
<input class='form-control' id='font-size' max='200' min='10' type='number' value='60'/>
</div>
<div class='form-group'>
<label for='font-unit'>Unidad</label>
<select class='form-control' id='font-unit'>
<option value='px'>px</option>
<option value='%'>%</option>
<option value='vw'>vw</option>
<option value='em'>em</option>
</select>
</div>
</div>
<div class='form-group'>
<label for='font-weight'>Grosor</label>
<select class='form-control' id='font-weight'>
<option value='normal'>Normal</option>
<option selected='selected' value='bold'>Negrita</option>
<option value='lighter'>Ligero</option>
<option value='bolder'>Extra negrita</option>
</select>
</div>
<div class='form-group'>
<label for='text-color'>Color del texto</label>
<input class='form-control' id='text-color' type='color' value='#FFFFFF'/>
<div class='color-picker'>
<div class='color-option' data-color='#FFFFFF' style='background-color: #FFFFFF;'>
</div>
<div class='color-option' data-color='#000000' style='background-color: #000000;'>
</div>
<div class='color-option' data-color='#1978d7' style='background-color: #1978d7;'>
</div>
<div class='color-option' data-color='#e74c3c' style='background-color: #e74c3c;'>
</div>
<div class='color-option' data-color='#2ecc71' style='background-color: #2ecc71;'>
</div>
<div class='color-option' data-color='#f39c12' style='background-color: #f39c12;'>
</div>
<div class='color-option' data-color='#9b59b6' style='background-color: #9b59b6;'>
</div>
<div class='color-option' data-color='#34495e' style='background-color: #34495e;'>
</div>
</div>
</div>
<div class='form-group'>
<label>Efectos de texto</label>
<div class='effects-panel'>
<div class='effect-option'>
<input class='form-control' id='text-shadow' type='checkbox'/>
<label for='text-shadow'>Sombra</label>
</div>
<div class='effect-option'>
<input class='form-control' id='text-outline' type='checkbox'/>
<label for='text-outline'>Contorno</label>
</div>
<div class='effect-option'>
<input class='form-control' id='text-italic' type='checkbox'/>
<label for='text-italic'>Cursiva</label>
</div>
</div>
</div>
</section>
<section class='glass-panel' id='background-panel'>
<h3 class='panel-title'>
<i class='fas fa-fill-drip'>
</i> Fondo</h3>
<div class='form-group'>
<label for='background-type'>Tipo de fondo</label>
<select class='form-control' id='background-type'>
<option value='color'>Color sólido</option>
<option value='gradient'>Gradiente</option>
<option value='transparent'>Transparente</option>
</select>
</div>
<div id='solid-color-options'>
<div class='form-group'>
<label for='background-color'>Color de fondo</label>
<input class='form-control' id='background-color' type='color' value='#1978d7'/>
<div class='color-picker'>
<div class='color-option' data-color='#1978d7' style='background-color: #1978d7;'>
</div>
<div class='color-option' data-color='#e74c3c' style='background-color: #e74c3c;'>
</div>
<div class='color-option' data-color='#2ecc71' style='background-color: #2ecc71;'>
</div>
<div class='color-option' data-color='#f39c12' style='background-color: #f39c12;'>
</div>
<div class='color-option' data-color='#9b59b6' style='background-color: #9b59b6;'>
</div>
<div class='color-option' data-color='#34495e' style='background-color: #34495e;'>
</div>
<div class='color-option' data-color='#FFFFFF' style='background-color: #FFFFFF;'>
</div>
<div class='color-option' data-color='#000000' style='background-color: #000000;'>
</div>
</div>
</div>
</div>
<div id='gradient-options' style='display: none;'>
<div class='form-group'>
<label for='gradient-type'>Tipo de gradiente</label>
<select class='form-control' id='gradient-type'>
<option value='linear'>Lineal</option>
<option value='radial'>Radial</option>
</select>
</div>
<div class='form-group'>
<label for='gradient-angle'>Ángulo (grados)</label>
<input class='form-control' id='gradient-angle' max='360' min='0' type='range' value='135'/>
</div>
<div class='form-group'>
<label>Colores del gradiente</label>
<div class='form-row'>
<div class='form-group'>
<input class='form-control' id='gradient-color-1' type='color' value='#1978d7'/>
</div>
<div class='form-group'>
<input class='form-control' id='gradient-color-2' type='color' value='#2ecc71'/>
</div>
</div>
<div class='gradient-preview' id='gradient-preview'>
</div>
</div>
</div>
<div class='form-group'>
<label for='border-radius'>Radio de borde</label>
<div class='form-row'>
<div class='form-group'>
<input class='form-control' id='border-radius' max='100' min='0' type='number' value='10'/>
</div>
<div class='form-group'>
<select class='form-control' id='border-radius-unit'>
<option value='px'>px</option>
<option value='%'>%</option>
<option value='vw'>vw</option>
</select>
</div>
</div>
</div>
</section>
<section class='glass-panel' id='shape-panel'>
<h3 class='panel-title'>
<i class='fas fa-shapes'>
</i> Formas</h3>
<div class='shapes-container'>
<div class='shape-item' data-shape='rectangle'>
<i class='fas fa-square'>
</i>
</div>
<div class='shape-item' data-shape='circle'>
<i class='fas fa-circle'>
</i>
</div>
<div class='shape-item' data-shape='triangle'>
<i class='fas fa-play'>
</i>
</div>
<div class='shape-item' data-shape='rounded-rectangle'>
<i class='fas fa-square'>
</i>
</div>
<div class='shape-item' data-shape='hexagon'>
<i class='fas fa-hexagon'>
</i>
</div>
<div class='shape-item' data-shape='star'>
<i class='fas fa-star'>
</i>
</div>
</div>
<div class='form-group' style='margin-top: 15px;'>
<label for='shape-color'>Color de forma</label>
<input class='form-control' id='shape-color' type='color' value='#1978d7'/>
</div>
</section>
<section class='glass-panel' id='image-panel'>
<h3 class='panel-title'>
<i class='fas fa-image'>
</i> Imágenes</h3>
<div class='image-upload-area' id='image-upload-area'>
<i class='fas fa-cloud-upload-alt'>
</i>
<p>Arrastra una imagen aquí o haz clic para seleccionar</p>
<input accept='image/*' id='image-upload' style='display: none;' type='file'/>
</div>
<div class='form-group'>
<button class='btn btn-primary' id='paste-image' style='width: 100%;'>
<i class='fas fa-paste'>
</i> Pegar desde portapapeles
</button>
</div>
</section>
<section class='glass-panel' id='dimensions-panel'>
<h3 class='panel-title'>
<i class='fas fa-ruler-combined'>
</i> Dimensiones</h3>
<div class='form-row'>
<div class='form-group'>
<label for='canvas-width'>Ancho</label>
<div class='dimensions-controls'>
<input class='form-control' id='canvas-width' max='2000' min='50' type='number' value='400'/>
<select class='form-control' id='width-unit'>
<option value='px'>px</option>
<option value='%'>%</option>
<option value='vw'>vw</option>
</select>
</div>
</div>
<div class='form-group'>
<label for='canvas-height'>Alto</label>
<div class='dimensions-controls'>
<input class='form-control' id='canvas-height' max='2000' min='50' type='number' value='400'/>
<select class='form-control' id='height-unit'>
<option value='px'>px</option>
<option value='%'>%</option>
<option value='vh'>vh</option>
</select>
</div>
</div>
</div>
<div class='form-group'>
<button class='btn btn-primary' id='apply-dimensions' style='width: 100%;'>
<i class='fas fa-check'>
</i> Aplicar dimensiones
</button>
</div>
</section>
<section class='glass-panel' id='templates-panel'>
<h3 class='panel-title'>
<i class='fas fa-palette'>
</i> Plantillas</h3>
<div class='templates-container'>
<div class='template-item' data-template='template1'>
<img alt='Template 1' src='https://placehold.co/120x80/1978d7/FFFFFF/png?text=Modern'/>
<div class='template-name'>Moderno</div>
</div>
<div class='template-item' data-template='template2'>
<img alt='Template 2' src='https://placehold.co/120x80/e74c3c/FFFFFF/png?text=Bold'/>
<div class='template-name'>Audaz</div>
</div>
<div class='template-item' data-template='template3'>
<img alt='Template 3' src='https://placehold.co/120x80/2ecc71/FFFFFF/png?text=Eco'/>
<div class='template-name'>Eco</div>
</div>
<div class='template-item' data-template='template4'>
<img alt='Template 4' src='https://placehold.co/120x80/9b59b6/FFFFFF/png?text=Creative'/>
<div class='template-name'>Creativo</div>
</div>
</div>
</section>
</aside>
<main class='glass-panel'>
<div class='tabs'>
<div class='tab active' data-tab='editor'>Editor</div>
<div class='tab' data-tab='layers'>Capas</div>
<div class='tab' data-tab='export'>Exportar</div>
<div class='tab' data-tab='preview'>Vista previa</div>
</div>
<div class='tab-content active' id='editor-tab'>
<div class='canvas-container'>
<div class='canvas-bg'>
</div>
<div id='logo-canvas'>
</div>
</div>
<div class='alignment-tools'>
<div class='alignment-tool' data-align='left' title='Alinear a la izquierda'>
<i class='fas fa-align-left'>
</i>
</div>
<div class='alignment-tool' data-align='center' title='Centrar horizontalmente'>
<i class='fas fa-align-center'>
</i>
</div>
<div class='alignment-tool' data-align='right' title='Alinear a la derecha'>
<i class='fas fa-align-right'>
</i>
</div>
<div class='alignment-tool' data-align='top' title='Alinear arriba'>
<i class='fas fa-arrow-up'>
</i>
</div>
<div class='alignment-tool' data-align='middle' title='Centrar verticalmente'>
<i class='fas fa-arrows-alt-v'>
</i>
</div>
<div class='alignment-tool' data-align='bottom' title='Alinear abajo'>
<i class='fas fa-arrow-down'>
</i>
</div>
</div>
</div>
<div class='tab-content' id='layers-tab'>
<div class='layers-panel'>
<div class='layer-item active'>
<i class='fas fa-font'>
</i> Texto principal
<div class='layer-controls'>
<i class='fas fa-arrow-up layer-up' title='Mover arriba'>
</i>
<i class='fas fa-arrow-down layer-down' title='Mover abajo'>
</i>
<i class='fas fa-trash layer-delete' title='Eliminar'>
</i>
</div>
</div>
<div class='layer-item'>
<i class='fas fa-square'>
</i> Forma de fondo
<div class='layer-controls'>
<i class='fas fa-arrow-up layer-up' title='Mover arriba'>
</i>
<i class='fas fa-arrow-down layer-down' title='Mover abajo'>
</i>
<i class='fas fa-trash layer-delete' title='Eliminar'>
</i>
</div>
</div>
</div>
<div style='margin-top: 15px;'>
<button class='btn' id='add-text-layer'>
<i class='fas fa-plus'>
</i> Añadir texto
</button>
<button class='btn' id='add-shape-layer'>
<i class='fas fa-plus'>
</i> Añadir forma
</button>
</div>
<div class='history-thumbnails'>
<div class='history-thumbnail active'>
<img alt='History 1' src='https://placehold.co/60x60/1978d7/FFFFFF/png?text=1'/>
</div>
<div class='history-thumbnail'>
<img alt='History 2' src='https://placehold.co/60x60/1978d7/FFFFFF/png?text=2'/>
</div>
</div>
</div>
<div class='tab-content' id='export-tab'>
<h3 class='panel-title'>
<i class='fas fa-file-export'>
</i> Exportar logo</h3>
<div class='export-options'>
<button class='btn' id='export-png'>
<i class='fas fa-file-image'>
</i> PNG
</button>
<button class='btn' id='export-svg'>
<i class='fas fa-bezier-curve'>
</i> SVG
</button>
<button class='btn' id='export-pdf'>
<i class='fas fa-file-pdf'>
</i> PDF
</button>
<button class='btn' id='export-ico'>
<i class='fas fa-file'>
</i> ICO
</button>
</div>
<div class='form-group' style='margin-top: 20px;'>
<label for='export-size'>Tamaño</label>
<select class='form-control' id='export-size'>
<option value='original'>Original</option>
<option value='sm'>Pequeño (256px)</option>
<option value='md'>Mediano (512px)</option>
<option value='lg'>Grande (1024px)</option>
<option value='xl'>Extra grande (2048px)</option>
</select>
</div>
<div class='form-group'>
<label for='export-quality'>Calidad</label>
<input class='form-control' id='export-quality' max='10' min='1' type='range' value='8'/>
</div>
<div class='form-group'>
<label>Presets para redes sociales</label>
<div class='export-options'>
<button class='btn' id='export-facebook'>
<i class='fab fa-facebook'>
</i> Facebook
</button>
<button class='btn' id='export-twitter'>
<i class='fab fa-twitter'>
</i> Twitter
</button>
<button class='btn' id='export-instagram'>
<i class='fab fa-instagram'>
</i> Instagram
</button>
<button class='btn' id='export-linkedin'>
<i class='fab fa-linkedin'>
</i> LinkedIn
</button>
</div>
</div>
</div>
<div class='tab-content' id='preview-tab'>
<h3 class='panel-title'>
<i class='fas fa-eye'>
</i> Vista previa</h3>
<div class='form-group'>
<label>Fondo de vista previa</label>
<div class='preview-backgrounds'>
<div class='preview-bg-option white' data-bg='white' title='Fondo blanco'>
</div>
<div class='preview-bg-option black' data-bg='black' title='Fondo negro'>
</div>
<div class='preview-bg-option pattern' data-bg='pattern' title='Patrón'>
</div>
<div class='preview-bg-option gradient' data-bg='gradient' title='Gradiente'>
</div>
</div>
</div>
<div class='form-group'>
<label>Vista previa en dispositivos</label>
<div class='preview-device-options'>
<div class='preview-device active' data-device='desktop'>
<i class='fas fa-desktop'>
</i> Escritorio
</div>
<div class='preview-device' data-device='tablet'>
<i class='fas fa-tablet-alt'>
</i> Tablet
</div>
<div class='preview-device' data-device='mobile'>
<i class='fas fa-mobile-alt'>
</i> Móvil
</div>
</div>
</div>
<div class='canvas-container' style='margin-top: 20px;'>
<div class='canvas-bg' id='preview-background'>
</div>
<div id='preview-canvas'>
</div>
</div>
</div>
</main>
</div>
<div class='preview-modal' id='preview-modal'>
<div class='preview-modal-content'>
<span class='preview-modal-close'><i class='wicon wi-x'></i></span>
<div id='modal-preview-canvas'>
</div>
</div>
</div>
<!--DIOS ES BUENO SIEMPRE[END]-->
<div class='no-items section' id='foooo' name='foooo'></div>
<script>
// ===============================================
// PARTE 1: INICIALIZACIÓN Y CONFIGURACIÓN BÁSICA
// ===============================================

// Inicializar la aplicación cuando el documento esté listo
$(document).ready(function() {
    initializeApp();
    setupEventListeners();
    updatePreview();
});

// Inicializar la aplicación
function initializeApp() {
    // Cargar fuentes
    loadFonts();
    
    // Inicializar el canvas con valores predeterminados
    initCanvas();
    
    // Mostrar la primera pestaña activa
    $('.tab-content').hide();
    $('#editor-tab').show();
    
    // Inicializar historial
    saveState();
    
    // Configurar atajos de teclado
    setupKeyboardShortcuts();
}

// Cargar fuentes web necesarias
function loadFonts() {
    const fontFamilies = [
        'Montserrat:wght@400;700',
        'Roboto:wght@400;700',
        'Open+Sans:wght@400;700',
        'Poppins:wght@400;700'
    ];
    
    // Agregar enlace a Google Fonts
    $('head').append('<link href="https://fonts.googleapis.com/css2?family=' + fontFamilies.join('&family=') + '&display=swap" rel="stylesheet">');
}

// Inicializar el canvas del logo
function initCanvas() {
    // Limpiar el canvas
    $('#logo-canvas').empty();
    
    // Crear forma de fondo predeterminada
    $('#logo-canvas').append('<div id="background-shape" class="logo-element"></div>');
    
    // Crear texto predeterminado
    $('#logo-canvas').append('<div id="logo-text-element" class="logo-element"></div>');
    
    // Aplicar estilos iniciales
    $('#background-shape').css({
        'position': 'absolute',
        'width': '100%',
        'height': '100%',
        'background-color': '#1978d7',
        'border-radius': '10px',
        'z-index': '1'
    });
    
    $('#logo-text-element').css({
        'position': 'absolute',
        'top': '50%',
        'left': '50%',
        'transform': 'translate(-50%, -50%)',
        'color': '#FFFFFF',
        'font-family': 'Arial Black, sans-serif',
        'font-size': '60px',
        'font-weight': 'bold',
        'z-index': '2',
        'text-align': 'center'
    }).text($('#logo-text').val() || 'WS');
    
    // Hacer elementos arrastrables
    makeElementDraggable('logo-text-element');
}

// Configurar atajos de teclado
function setupKeyboardShortcuts() {
    $(document).on('keydown', function(e) {
        // Ctrl+Z: Deshacer
        if (e.ctrlKey && e.key === 'z') {
            e.preventDefault();
            undoAction();
        }
        
        // Ctrl+Y: Rehacer
        if (e.ctrlKey && e.key === 'y') {
            e.preventDefault();
            redoAction();
        }
        
        // Ctrl+G: Mostrar/ocultar cuadrícula
        if (e.ctrlKey && e.key === 'g') {
            e.preventDefault();
            toggleGrid();
        }
        
        // Ctrl+S: Guardar (exportar como PNG)
        if (e.ctrlKey && e.key === 's') {
            e.preventDefault();
            exportLogo('png');
        }
    });
}

// ===============================================
// PARTE 2: CONFIGURACIÓN DE EVENTOS
// ===============================================

// Configurar todos los event listeners
function setupEventListeners() {
    // Eventos de pestañas
    $('.tab').on('click', function() {
        $('.tab').removeClass('active');
        $(this).addClass('active');
        
        $('.tab-content').removeClass('active').hide();
        $('#' + $(this).data('tab') + '-tab').addClass('active').show();
        
        // Si cambiamos a la pestaña de vista previa, actualizar
        if ($(this).data('tab') === 'preview') {
            updatePreviewTab();
        }
    });
    
    // Eventos de texto
    $('#logo-text').on('input', function() {
        updateLogoText($(this).val());
    });
    
    $('#font-family').on('change', function() {
        updateTextStyle('font-family', $(this).val() + ', sans-serif');
    });
    
    $('#font-size').on('input', function() {
        const unit = $('#font-unit').val();
        updateTextStyle('font-size', $(this).val() + unit);
    });
    
    $('#font-unit').on('change', function() {
        const size = $('#font-size').val();
        updateTextStyle('font-size', size + $(this).val());
    });
    
    $('#font-weight').on('change', function() {
        updateTextStyle('font-weight', $(this).val());
    });
    
    $('#text-color').on('input', function() {
        updateTextStyle('color', $(this).val());
    });
    
    // Eventos de efectos de texto
    $('#text-shadow').on('change', function() {
        if ($(this).is(':checked')) {
            applyTextEffect('shadow');
        } else {
            $('#logo-text-element').css('text-shadow', 'none');
        }
        saveState();
    });
    
    $('#text-outline').on('change', function() {
        if ($(this).is(':checked')) {
            applyTextEffect('outline');
        } else {
            $('#logo-text-element').css({
                '-webkit-text-stroke': 'initial',
                'text-stroke': 'initial'
            });
        }
        saveState();
    });
    
    $('#text-italic').on('change', function() {
        if ($(this).is(':checked')) {
            $('#logo-text-element').css('font-style', 'italic');
        } else {
            $('#logo-text-element').css('font-style', 'normal');
        }
        saveState();
    });
    
    // Eventos de fondo
    $('#background-type').on('change', function() {
        updateBackgroundType($(this).val());
    });
    
    $('#background-color').on('input', function() {
        updateBackgroundColor($(this).val());
    });
    
    $('#gradient-type, #gradient-angle, #gradient-color-1, #gradient-color-2').on('input change', function() {
        updateGradient();
    });
    
    $('#border-radius').on('input', function() {
        const unit = $('#border-radius-unit').val();
        updateBorderRadius($(this).val() + unit);
    });
    
    $('#border-radius-unit').on('change', function() {
        const radius = $('#border-radius').val();
        updateBorderRadius(radius + $(this).val());
    });
    
    // Eventos de color rápido
    $('.color-option').on('click', function() {
        const color = $(this).data('color');
        const parent = $(this).closest('.form-group');
        
        if (parent.find('#text-color').length) {
            $('#text-color').val(color);
            updateTextStyle('color', color);
        } else if (parent.find('#background-color').length) {
            $('#background-color').val(color);
            updateBackgroundColor(color);
        } else if (parent.find('#shape-color').length) {
            $('#shape-color').val(color);
            updateShapeStyle('background-color', color);
        }
    });
    
    // Eventos de formas
    $('.shape-item').on('click', function() {
        $('.shape-item').removeClass('active');
        $(this).addClass('active');
        addShape($(this).data('shape'));
    });
    
    $('#shape-color').on('input', function() {
        updateShapeStyle('background-color', $(this).val());
    });
    
    // Eventos de imágenes
    $('#image-upload-area').on('click', function() {
        $('#image-upload').click();
    });
    
    $('#image-upload').on('change', function(e) {
        handleImageUpload(e.target.files[0]);
    });
    
    $('#image-upload-area').on('dragover', function(e) {
        e.preventDefault();
        $(this).addClass('dragover');
    }).on('dragleave', function() {
        $(this).removeClass('dragover');
    }).on('drop', function(e) {
        e.preventDefault();
        $(this).removeClass('dragover');
        
        if (e.originalEvent.dataTransfer.files.length) {
            handleImageUpload(e.originalEvent.dataTransfer.files[0]);
        }
    });
    
    $('#paste-image').on('click', function() {
        showNotification('Presiona Ctrl+V para pegar una imagen del portapapeles', 'info');
    });
    
    $(document).on('paste', function(e) {
        handlePastedImage(e.originalEvent);
    });
    
    // Eventos de dimensiones
    $('#apply-dimensions').on('click', function() {
        const width = $('#canvas-width').val() + $('#width-unit').val();
        const height = $('#canvas-height').val() + $('#height-unit').val();
        updateCanvasDimensions(width, height);
    });
    
    // Eventos de plantillas
    $('.template-item').on('click', function() {
        applyTemplate($(this).data('template'));
    });
    
    // Eventos de alineación
    $('.alignment-tool').on('click', function() {
        alignElement('logo-text-element', $(this).data('align'));
    });
    
    // Eventos de capas
    $('.layer-item').on('click', function() {
        selectLayer($(this).data('element'));
    });
    
    $('.layer-up').on('click', function(e) {
        e.stopPropagation();
        const layerItem = $(this).closest('.layer-item');
        moveLayer(layerItem.data('element'), 'up');
    });
    
    $('.layer-down').on('click', function(e) {
        e.stopPropagation();
        const layerItem = $(this).closest('.layer-item');
        moveLayer(layerItem.data('element'), 'down');
    });
    
    $('.layer-delete').on('click', function(e) {
        e.stopPropagation();
        const layerItem = $(this).closest('.layer-item');
        deleteLayer(layerItem.data('element'));
    });
    
    $('#add-text-layer').on('click', function() {
        addTextElement('Nuevo texto');
    });
    
    $('#add-shape-layer').on('click', function() {
        addShape('rectangle');
    });
    
    // Eventos de exportación
    $('#export-png').on('click', function() {
        exportLogo('png');
    });
    
    $('#export-svg').on('click', function() {
        exportLogo('svg');
    });
    
    $('#export-pdf').on('click', function() {
        exportLogo('pdf');
    });
    
    $('#export-ico').on('click', function() {
        exportLogo('ico');
    });
    
    // Eventos de redes sociales
    $('#export-facebook, #export-twitter, #export-instagram, #export-linkedin').on('click', function() {
        const network = $(this).attr('id').replace('export-', '');
        exportForSocialMedia(network);
    });
    
    // Eventos de vista previa
    $('.preview-bg-option').on('click', function() {
        $('.preview-bg-option').removeClass('active');
        $(this).addClass('active');
        changePreviewBackground($(this).data('bg'));
    });
    
    $('.preview-device').on('click', function() {
        $('.preview-device').removeClass('active');
        $(this).addClass('active');
        changePreviewDevice($(this).data('device'));
    });
    
    // Eventos de herramientas
    $('#btn-undo').on('click', undoAction);
    $('#btn-redo').on('click', redoAction);
    $('#btn-grid').on('click', toggleGrid);
    $('#btn-preview').on('click', showPreviewModal);
    
    // Evento para cerrar modal de vista previa
    $('.preview-modal-close').on('click', function() {
        $('#preview-modal').hide();
    });
    
    // Cerrar modal al hacer clic fuera
    $(window).on('click', function(e) {
        if ($(e.target).is('#preview-modal')) {
            $('#preview-modal').hide();
        }
    });
}

// ===============================================
// PARTE 3: MANIPULACIÓN DE TEXTO
// ===============================================

// Actualizar el texto del logo
function updateLogoText(text) {
    $('#logo-text-element').text(text);
    saveState();
}

// Actualizar estilos de texto
function updateTextStyle(property, value) {
    $('#logo-text-element').css(property, value);
    saveState();
}

// Aplicar efectos de texto (sombra, etc.)
function applyTextEffect(effect) {
    switch(effect) {
        case 'shadow':
            $('#logo-text-element').css('text-shadow', '2px 2px 4px rgba(0,0,0,0.5)');
            break;
        case 'outline':
            $('#logo-text-element').css({
                '-webkit-text-stroke': '1px black',
                'text-stroke': '1px black'
            });
            break;
    }
    saveState();
}

// Añadir nuevo elemento de texto
function addTextElement(text) {
    const textId = 'text-' + generateUniqueId();
    const textElement = $('<div id="' + textId + '" class="logo-element text-element"></div>');
    
    $('#logo-canvas').append(textElement);
    
    textElement.css({
        'position': 'absolute',
        'top': '50%',
        'left': '50%',
        'transform': 'translate(-50%, -50%)',
        'color': '#000000',
        'font-family': 'Arial, sans-serif',
        'font-size': '30px',
        'font-weight': 'normal',
        'z-index': getHighestZIndex() + 1,
        'cursor': 'move',
        'text-align': 'center'
    }).text(text);
    
    // Hacer el texto arrastrable
    makeElementDraggable(textId);
    
    // Añadir a la lista de capas
    addLayerItem(textId, 'text', text);
    
    saveState();
    return textId;
}

// Actualizar posición del texto
function updateTextPosition(elementId, x, y) {
    $('#' + elementId).css({
        'left': x + 'px',
        'top': y + 'px',
        'transform': 'none'
    });
    saveState();
}

// ===============================================
// PARTE 4: MANIPULACIÓN DE FONDO Y COLORES
// ===============================================

// Cambiar tipo de fondo
function updateBackgroundType(type) {
    switch(type) {
        case 'color':
            $('#solid-color-options').show();
            $('#gradient-options').hide();
            updateBackgroundColor($('#background-color').val());
            break;
        case 'gradient':
            $('#solid-color-options').hide();
            $('#gradient-options').show();
            updateGradient();
            break;
        case 'transparent':
            $('#solid-color-options').hide();
            $('#gradient-options').hide();
            $('#background-shape').css('background', 'transparent');
            break;
    }
    saveState();
}

// Actualizar color de fondo
function updateBackgroundColor(color) {
    $('#background-shape').css('background', color);
    saveState();
}

// Actualizar gradiente
function updateGradient() {
    const type = $('#gradient-type').val();
    const angle = $('#gradient-angle').val();
    const color1 = $('#gradient-color-1').val();
    const color2 = $('#gradient-color-2').val();
    
    let gradient;
    if (type === 'linear') {
        gradient = 'linear-gradient(' + angle + 'deg, ' + color1 + ', ' + color2 + ')';
    } else {
        gradient = 'radial-gradient(circle, ' + color1 + ', ' + color2 + ')';
    }
    
    // Actualizar vista previa
    $('#gradient-preview').css('background', gradient);
    
    // Aplicar al fondo
    $('#background-shape').css('background', gradient);
    
    saveState();
}

// Actualizar radio de bordes
function updateBorderRadius(radius) {
    $('#background-shape').css('border-radius', radius);
    saveState();
}

// ===============================================
// PARTE 5: FORMAS Y ELEMENTOS GRÁFICOS
// ===============================================

// Añadir nueva forma
function addShape(shapeType) {
    const shapeId = 'shape-' + generateUniqueId();
    const shape = $('<div id="' + shapeId + '" class="logo-element shape-element"></div>');
    
    $('#logo-canvas').append(shape);
    
    // Estilos base para todas las formas
    shape.css({
        'position': 'absolute',
        'width': '100px',
        'height': '100px',
        'background-color': $('#shape-color').val() || '#1978d7',
        'z-index': getHighestZIndex() + 1,
        'top': '50%',
        'left': '50%',
        'transform': 'translate(-50%, -50%)',
        'cursor': 'move'
    });
    
    // Aplicar estilos según el tipo
    changeShapeType(shapeId, shapeType);
    
    // Hacer la forma arrastrable y redimensionable
    makeElementDraggable(shapeId);
    makeElementResizable(shapeId);
    
    // Añadir a la lista de capas
    addLayerItem(shapeId, 'shape', 'Forma ' + shapeType);
    
    // Seleccionar la nueva forma
    selectLayer(shapeId);
    
    saveState();
    return shapeId;
}

// Cambiar tipo de forma
function changeShapeType(shapeId, shapeType) {
    const shape = $('#' + shapeId);
    
    // Restablecer estilos
    shape.css({
        'border-radius': '0',
        'clip-path': 'none',
        'background-color': $('#shape-color').val() || '#1978d7',
        'border': 'none',
        'width': '100px',
        'height': '100px'
    });
    
    switch(shapeType) {
        case 'rectangle':
            // No se necesitan cambios adicionales
            break;
        case 'circle':
            shape.css('border-radius', '50%');
            break;
        case 'triangle':
            shape.css({
                'width': '0',
                'height': '0',
                'background-color': 'transparent',
                'border-left': '50px solid transparent',
                'border-right': '50px solid transparent',
                'border-bottom': '100px solid ' + ($('#shape-color').val() || '#1978d7')
            });
            break;
        case 'rounded-rectangle':
            shape.css('border-radius', '15px');
            break;
        case 'hexagon':
            shape.css({
                'clip-path': 'polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%)'
            });
            break;
        case 'star':
            shape.css({
                'clip-path': 'polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)'
            });
            break;
    }
    
    saveState();
}

// Actualizar estilos de forma
function updateShapeStyle(property, value) {
    // Obtener el elemento seleccionado
    const selectedLayer = $('.layer-item.active').data('element');
    
    if (selectedLayer && selectedLayer.startsWith('shape-')) {
        $('#' + selectedLayer).css(property, value);
        saveState();
    }
}

// ===============================================
// PARTE 6: GESTIÓN DE IMÁGENES
// ===============================================

// Procesar imagen subida
function handleImageUpload(file) {
    if (!file || !file.type.match('image.*')) {
        showNotification('Por favor, selecciona un archivo de imagen válido', 'error');
        return;
    }
    
    const reader = new FileReader();
    
    reader.onload = function(e) {
        addImageToCanvas(e.target.result);
    };
    
    reader.readAsDataURL(file);
}

// Procesar imagen pegada
function handlePastedImage(event) {
    if (event.clipboardData && event.clipboardData.items) {
        const items = event.clipboardData.items;
        
        for (let i = 0; i < items.length; i++) {
            if (items[i].type.indexOf('image') !== -1) {
                const blob = items[i].getAsFile();
                handleImageUpload(blob);
                return;
            }
        }
    }
    
    showNotification('No se encontró ninguna imagen en el portapapeles', 'warning');
}

// Añadir imagen al canvas
function addImageToCanvas(imageUrl) {
    const imageId = 'image-' + generateUniqueId();
    const img = new Image();
    
    img.onload = function() {
        // Crear contenedor para la imagen
        const imageContainer = $('<div id="' + imageId + '" class="logo-element image-element"></div>');
        
        // Crear la imagen
        const imageElement = $('<img src="' + imageUrl + '" alt="Logo image">');
        
        // Añadir la imagen al contenedor
        imageContainer.append(imageElement);
        
        // Añadir el contenedor al canvas
        $('#logo-canvas').append(imageContainer);
        
        // Estilos para el contenedor
        imageContainer.css({
            'position': 'absolute',
            'top': '50%',
            'left': '50%',
            'transform': 'translate(-50%, -50%)',
            'z-index': getHighestZIndex() + 1,
            'cursor': 'move',
            'max-width': '80%',
            'max-height': '80%'
        });
        
        // Estilos para la imagen
        imageElement.css({
            'width': '100%',
            'height': '100%',
            'object-fit': 'contain'
        });
        
        // Hacer la imagen arrastrable y redimensionable
        makeElementDraggable(imageId);
        makeElementResizable(imageId);
        
        // Añadir a la lista de capas
        addLayerItem(imageId, 'image', 'Imagen');
        
        // Seleccionar la nueva imagen
        selectLayer(imageId);
        
        saveState();
    };
    
    img.src = imageUrl;
}

// Redimensionar imagen
function resizeImage(imageId, width, height) {
    $('#' + imageId).css({
        'width': width + 'px',
        'height': height + 'px'
    });
    
    saveState();
}

// ===============================================
// PARTE 7: SISTEMA DE CAPAS
// ===============================================

// Añadir elemento a la lista de capas
function addLayerItem(elementId, type, name) {
    let icon;
    switch(type) {
        case 'text': icon = 'font'; break;
        case 'shape': icon = 'square'; break;
        case 'image': icon = 'image'; break;
        default: icon = 'object-group';
    }
    
    const layerItem = $('<div class="layer-item" data-element="' + elementId + '">' +
                        '<i class="fas fa-' + icon + '"></i> ' + name +
                        '<div class="layer-controls">' +
                        '<i class="fas fa-arrow-up layer-up" title="Mover arriba"></i>' +
                        '<i class="fas fa-arrow-down layer-down" title="Mover abajo"></i>' +
                        '<i class="fas fa-trash layer-delete" title="Eliminar"></i>' +
                        '</div></div>');
    
    $('.layers-panel').prepend(layerItem);
    
    // Añadir eventos a los controles de capa
    layerItem.find('.layer-up').on('click', function(e) {
        e.stopPropagation();
        moveLayer(elementId, 'up');
    });
    
    layerItem.find('.layer-down').on('click', function(e) {
        e.stopPropagation();
        moveLayer(elementId, 'down');
    });
    
    layerItem.find('.layer-delete').on('click', function(e) {
        e.stopPropagation();
        deleteLayer(elementId);
    });
    
    layerItem.on('click', function() {
        selectLayer(elementId);
    });
    
    // Seleccionar esta capa
    selectLayer(elementId);
}

// Seleccionar una capa
function selectLayer(elementId) {
    $('.layer-item').removeClass('active');
    $('.layer-item[data-element="' + elementId + '"]').addClass('active');
    
    // Resaltar el elemento en el canvas
    $('.logo-element').css('outline', 'none');
    $('#' + elementId).css('outline', '2px dashed #1978d7');
}

// Mover capa arriba/abajo
function moveLayer(elementId, direction) {
    const element = $('#' + elementId);
    const zIndex = parseInt(element.css('z-index')) || 1;
    
    if (direction === 'up') {
        element.css('z-index', zIndex + 1);
    } else if (direction === 'down' && zIndex > 1) {
        element.css('z-index', zIndex - 1);
    }
    
    saveState();
}

// Eliminar capa
function deleteLayer(elementId) {
    $('#' + elementId).remove();
    $('.layer-item[data-element="' + elementId + '"]').remove();
    saveState();
}

// Obtener el z-index más alto
function getHighestZIndex() {
    let highest = 1;
    $('.logo-element').each(function() {
        const zIndex = parseInt($(this).css('z-index')) || 1;
        if (zIndex > highest) {
            highest = zIndex;
        }
    });
    return highest;
}

// ===============================================
// PARTE 8: DIMENSIONES, ALINEACIÓN Y POSICIONAMIENTO
// ===============================================

// Actualizar dimensiones del canvas
function updateCanvasDimensions(width, height) {
    $('#logo-canvas').css({
        'width': width,
        'height': height
    });
    
    // Actualizar campos de dimensiones
    $('#canvas-width').val(parseInt(width));
    $('#canvas-height').val(parseInt(height));
    
    saveState();
}

// Alinear elemento
function alignElement(elementId, alignment) {
    const element = $('#' + elementId);
    const canvas = $('#logo-canvas');
    
    switch(alignment) {
        case 'left':
            element.css({
                'left': '0',
                'transform': 'translateX(0) translateY(-50%)'
            });
            break;
        case 'center':
            element.css({
                'left': '50%',
                'transform': 'translateX(-50%) translateY(-50%)'
            });
            break;
        case 'right':
            element.css({
                'left': canvas.width() + 'px',
                'transform': 'translateX(-100%) translateY(-50%)'
            });
            break;
        case 'top':
            element.css({
                'top': '0',
                'transform': 'translateX(-50%) translateY(0)'
            });
            break;
        case 'middle':
            element.css({
                'top': '50%',
                'transform': 'translateX(-50%) translateY(-50%)'
            });
            break;
        case 'bottom':
            element.css({
                'top': canvas.height() + 'px',
                'transform': 'translateX(-50%) translateY(-100%)'
            });
            break;
    }
    
    saveState();
}

// Hacer que un elemento sea arrastrable
function makeElementDraggable(elementId) {
    let isDragging = false;
    let offsetX, offsetY;
    
    const element = $('#' + elementId);
    
    element.on('mousedown', function(e) {
        isDragging = true;
        
        // Calcular offset desde el punto de clic
        const rect = element[0].getBoundingClientRect();
        offsetX = e.clientX - rect.left;
        offsetY = e.clientY - rect.top;
        
        // Seleccionar esta capa
        selectLayer(elementId);
        
        // Prevenir selección de texto
        e.preventDefault();
    });
    
    $(document).on('mousemove', function(e) {
        if (!isDragging) return;
        
        const canvas = $('#logo-canvas')[0].getBoundingClientRect();
        const x = e.clientX - canvas.left - offsetX;
        const y = e.clientY - canvas.top - offsetY;
        
        element.css({
            'left': x + 'px',
            'top': y + 'px',
            'transform': 'none'
        });
    });
    
    $(document).on('mouseup', function() {
        if (isDragging) {
            isDragging = false;
            saveState();
        }
    });
}

// Hacer que un elemento sea redimensionable
function makeElementResizable(elementId) {
    const element = $('#' + elementId);
    
    // Añadir controladores de redimensionamiento
    const handles = [
        $('<div class="resize-handle top-left"></div>'),
        $('<div class="resize-handle top-right"></div>'),
        $('<div class="resize-handle bottom-left"></div>'),
        $('<div class="resize-handle bottom-right"></div>')
    ];
    
    handles.forEach(handle => {
        element.append(handle);
    });
    
    // Implementar redimensionamiento
    let isResizing = false;
    let currentHandle = null;
    let startX, startY, startWidth, startHeight;
    
    $('.resize-handle').on('mousedown', function(e) {
        isResizing = true;
        currentHandle = $(this);
        
        const rect = element[0].getBoundingClientRect();
        startX = e.clientX;
        startY = e.clientY;
        startWidth = rect.width;
        startHeight = rect.height;
        
        e.stopPropagation();
        e.preventDefault();
    });
    
    $(document).on('mousemove', function(e) {
        if (!isResizing) return;
        
        let newWidth, newHeight;
        
        if (currentHandle.hasClass('bottom-right')) {
            newWidth = startWidth + (e.clientX - startX);
            newHeight = startHeight + (e.clientY - startY);
        } else if (currentHandle.hasClass('bottom-left')) {
            newWidth = startWidth - (e.clientX - startX);
            newHeight = startHeight + (e.clientY - startY);
            if (newWidth > 20) {
                element.css('left', (element.position().left + (e.clientX - startX)) + 'px');
            }
        } else if (currentHandle.hasClass('top-right')) {
            newWidth = startWidth + (e.clientX - startX);
            newHeight = startHeight - (e.clientY - startY);
            if (newHeight > 20) {
                element.css('top', (element.position().top + (e.clientY - startY)) + 'px');
            }
        } else if (currentHandle.hasClass('top-left')) {
            newWidth = startWidth - (e.clientX - startX);
            newHeight = startHeight - (e.clientY - startY);
            if (newWidth > 20) {
                element.css('left', (element.position().left + (e.clientX - startX)) + 'px');
            }
            if (newHeight > 20) {
                element.css('top', (element.position().top + (e.clientY - startY)) + 'px');
            }
        }
        
        if (newWidth > 20) {
            element.css('width', newWidth + 'px');
        }
        if (newHeight > 20) {
            element.css('height', newHeight + 'px');
        }
    });
    
    $(document).on('mouseup', function() {
        if (isResizing) {
            isResizing = false;
            currentHandle = null;
            saveState();
        }
    });
}

// ===============================================
// PARTE 9: PLANTILLAS Y PRESETS
// ===============================================

// Aplicar plantilla predefinida
function applyTemplate(templateId) {
    switch(templateId) {
        case 'template1':
            // Plantilla moderna azul
            $('#background-shape').css({
                'background-color': '#1978d7',
                'border-radius': '10px',
                'width': '100%',
                'height': '100%'
            });
            
            $('#logo-text-element').css({
                'color': '#FFFFFF',
                'font-family': 'Montserrat, sans-serif',
                'font-size': '60px',
                'font-weight': 'bold',
                'text-shadow': '2px 2px 4px rgba(0,0,0,0.3)'
            });
            
            // Actualizar controles de UI
            $('#background-type').val('color');
            $('#background-color').val('#1978d7');
            $('#text-color').val('#FFFFFF');
            $('#font-family').val('Montserrat');
            $('#font-size').val('60');
            $('#font-unit').val('px');
            $('#border-radius').val('10');
            $('#border-radius-unit').val('px');
            $('#text-shadow').prop('checked', true);
            
            // Mostrar/ocultar opciones relevantes
            $('#solid-color-options').show();
            $('#gradient-options').hide();
            break;
            
        case 'template2':
            // Plantilla audaz roja
            $('#background-shape').css({
                'background-color': '#e74c3c',
                'border-radius': '0',
                'width': '100%',
                'height': '100%'
            });
            
            $('#logo-text-element').css({
                'color': '#FFFFFF',
                'font-family': 'Arial Black, sans-serif',
                'font-size': '70px',
                'font-weight': 'bold',
                'text-shadow': 'none',
                'text-transform': 'uppercase'
            });
            
            // Actualizar controles de UI
            $('#background-type').val('color');
            $('#background-color').val('#e74c3c');
            $('#text-color').val('#FFFFFF');
            $('#font-family').val('Arial Black');
            $('#font-size').val('70');
            $('#font-unit').val('px');
            $('#border-radius').val('0');
            $('#border-radius-unit').val('px');
            $('#text-shadow').prop('checked', false);
            
            // Mostrar/ocultar opciones relevantes
            $('#solid-color-options').show();
            $('#gradient-options').hide();
            break;
            
        case 'template3':
            // Plantilla eco verde
            $('#background-shape').css({
                'background': 'linear-gradient(135deg, #2ecc71, #27ae60)',
                'border-radius': '50%',
                'width': '100%',
                'height': '100%'
            });
            
            $('#logo-text-element').css({
                'color': '#FFFFFF',
                'font-family': 'Poppins, sans-serif',
                'font-size': '55px',
                'font-weight': 'normal',
                'text-shadow': 'none'
            });
            
            // Actualizar controles de UI
            $('#background-type').val('gradient');
            $('#gradient-type').val('linear');
            $('#gradient-angle').val('135');
            $('#gradient-color-1').val('#2ecc71');
            $('#gradient-color-2').val('#27ae60');
            $('#text-color').val('#FFFFFF');
            $('#font-family').val('Poppins');
            $('#font-size').val('55');
            $('#font-unit').val('px');
            $('#border-radius').val('50');
            $('#border-radius-unit').val('%');
            $('#text-shadow').prop('checked', false);
            
            // Mostrar/ocultar opciones relevantes
            $('#solid-color-options').hide();
            $('#gradient-options').show();
            
            // Actualizar vista previa de gradiente
            updateGradient();
            break;
            
        case 'template4':
            // Plantilla creativa púrpura
            $('#background-shape').css({
                'background-color': '#9b59b6',
                'border-radius': '15px',
                'width': '100%',
                'height': '100%'
            });
            
            $('#logo-text-element').css({
                'color': '#FFFFFF',
                'font-family': 'Roboto, sans-serif',
                'font-size': '60px',
                'font-weight': 'bold',
                'font-style': 'italic',
                'text-shadow': '3px 3px 0px rgba(0,0,0,0.2)'
            });
            
            // Actualizar controles de UI
            $('#background-type').val('color');
            $('#background-color').val('#9b59b6');
            $('#text-color').val('#FFFFFF');
            $('#font-family').val('Roboto');
            $('#font-size').val('60');
            $('#font-unit').val('px');
            $('#border-radius').val('15');
            $('#border-radius-unit').val('px');
            $('#text-shadow').prop('checked', true);
            $('#text-italic').prop('checked', true);
            
            // Mostrar/ocultar opciones relevantes
            $('#solid-color-options').show();
            $('#gradient-options').hide();
            break;
    }
    
    saveState();
}

// Guardar configuración actual como plantilla
function saveAsTemplate(name) {
    // Esta función podría implementarse para guardar plantillas personalizadas
    showNotification('Plantilla guardada: ' + name, 'success');
}
// ===============================================
// PARTE 10: EXPORTACIÓN Y FORMATOS
// ===============================================

// Exportar logo en diferentes formatos
function exportLogo(format) {
    // Ocultar temporalmente los controles de redimensionamiento
    $('.resize-handle').hide();
    
    showNotification('Preparando exportación...', 'info');
    
    // Verificar que el elemento logo-canvas exista y tenga dimensiones
    const logoCanvasElement = document.getElementById('logo-canvas');
    if (!logoCanvasElement) {
        showNotification('Error: No se encontró el elemento logo-canvas', 'error');
        return;
    }
    
    console.log('Dimensiones del logo-canvas:', {
        offsetWidth: logoCanvasElement.offsetWidth,
        offsetHeight: logoCanvasElement.offsetHeight,
        clientWidth: logoCanvasElement.clientWidth,
        clientHeight: logoCanvasElement.clientHeight,
        style: {
            width: logoCanvasElement.style.width,
            height: logoCanvasElement.style.height,
            display: window.getComputedStyle(logoCanvasElement).display,
            visibility: window.getComputedStyle(logoCanvasElement).visibility
        }
    });
    
    // Asegurar que el fondo tenga las propiedades correctas
    $('#background-shape').css({
        'position': 'absolute',
        'width': '100%',
        'height': '100%',
        'top': '0',
        'left': '0',
        'z-index': '1',
        'display': 'block',
        'visibility': 'visible'
    });
    
    // Asegurar que el texto sea visible
    $('#logo-text-element').css({
        'z-index': '2',
        'display': 'block',
        'visibility': 'visible'
    });
    
    // Asegurar que el logo-canvas tenga dimensiones explícitas
    if (!logoCanvasElement.style.width || !logoCanvasElement.style.height) {
        $(logoCanvasElement).css({
            'width': '300px',
            'height': '300px',
            'position': 'relative',
            'display': 'block',
            'visibility': 'visible'
        });
    }
    
    // Método alternativo: usar directamente la API de Canvas
    function exportDirectly() {
        try {
            // Crear un canvas manualmente
            const canvas = document.createElement('canvas');
            const width = logoCanvasElement.offsetWidth || 300;
            const height = logoCanvasElement.offsetHeight || 300;
            
            canvas.width = width;
            canvas.height = height;
            
            const ctx = canvas.getContext('2d');
            
            // Dibujar fondo
            const bgElement = document.getElementById('background-shape');
            const bgStyle = window.getComputedStyle(bgElement);
            
            ctx.fillStyle = bgStyle.backgroundColor || '#ffffff';
            
            // Dibujar rectángulo con border-radius si es necesario
            const borderRadius = parseInt(bgStyle.borderRadius) || 0;
            
            if (borderRadius > 0) {
                // Dibujar rectángulo con esquinas redondeadas
                roundRect(ctx, 0, 0, width, height, borderRadius);
                ctx.fill();
            } else {
                // Rectángulo simple
                ctx.fillRect(0, 0, width, height);
            }
            
            // Dibujar texto
            const textElement = document.getElementById('logo-text-element');
            const textStyle = window.getComputedStyle(textElement);
            const text = textElement.textContent || 'WS';
            
            ctx.fillStyle = textStyle.color || '#000000';
            ctx.font = `${textStyle.fontWeight} ${textStyle.fontSize} ${textStyle.fontFamily}`;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            
            // Posición del texto
            let textX = width / 2;
            let textY = height / 2;
            
            // Si el texto tiene posición específica, usarla
            if (textStyle.left !== '50%') {
                textX = parseFloat(textStyle.left) + parseFloat(textStyle.width) / 2;
            }
            if (textStyle.top !== '50%') {
                textY = parseFloat(textStyle.top) + parseFloat(textStyle.height) / 2;
            }
            
            ctx.fillText(text, textX, textY);
            
            // Procesar según el formato solicitado
            switch(format) {
                case 'png':
                    exportAsPNGDirect(canvas);
                    break;
                case 'svg':
                    exportAsSVG();
                    break;
                case 'pdf':
                    exportAsPDFDirect(canvas);
                    break;
                case 'ico':
                    exportAsICODirect(canvas);
                    break;
            }
        } catch (error) {
            console.error("Error en exportación directa:", error);
            showNotification('Error al exportar: ' + error.message, 'error');
            $('.resize-handle').show();
        }
    }
    
    // Función auxiliar para dibujar rectángulos con esquinas redondeadas
    function roundRect(ctx, x, y, width, height, radius) {
        ctx.beginPath();
        ctx.moveTo(x + radius, y);
        ctx.lineTo(x + width - radius, y);
        ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
        ctx.lineTo(x + width, y + height - radius);
        ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
        ctx.lineTo(x + radius, y + height);
        ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
        ctx.lineTo(x, y + radius);
        ctx.quadraticCurveTo(x, y, x + radius, y);
        ctx.closePath();
    }
    
    // Intentar primero con html2canvas
    setTimeout(function() {
        html2canvas(logoCanvasElement, { 
            backgroundColor: null,
            useCORS: true,
            allowTaint: true,
            scale: 2,
            logging: true,
            onclone: function(clonedDoc) {
                // Asegurar que el clon tenga estilos correctos
                const clonedCanvas = clonedDoc.getElementById('logo-canvas');
                if (clonedCanvas) {
                    clonedCanvas.style.width = logoCanvasElement.offsetWidth + 'px';
                    clonedCanvas.style.height = logoCanvasElement.offsetHeight + 'px';
                    clonedCanvas.style.display = 'block';
                    clonedCanvas.style.visibility = 'visible';
                    
                    // Asegurar que el fondo sea visible
                    const clonedBg = clonedDoc.getElementById('background-shape');
                    if (clonedBg) {
                        clonedBg.style.width = '100%';
                        clonedBg.style.height = '100%';
                        clonedBg.style.display = 'block';
                        clonedBg.style.visibility = 'visible';
                    }
                    
                    // Asegurar que el texto sea visible
                    const clonedText = clonedDoc.getElementById('logo-text-element');
                    if (clonedText) {
                        clonedText.style.display = 'block';
                        clonedText.style.visibility = 'visible';
                    }
                }
            }
        }).then(function(canvas) {
            // Restaurar controles
            $('.resize-handle').show();
            
            // Verificar que el canvas tenga dimensiones válidas
            if (canvas.width === 0 || canvas.height === 0) {
                console.warn('html2canvas generó un canvas con dimensiones inválidas, usando método alternativo');
                exportDirectly();
                return;
            }
            
            console.log('Canvas generado correctamente:', {
                width: canvas.width,
                height: canvas.height
            });
            
            switch(format) {
                case 'png':
                    exportAsPNG(canvas);
                    break;
                case 'svg':
                    exportAsSVG();
                    break;
                case 'pdf':
                    exportAsPDF(canvas);
                    break;
                case 'ico':
                    exportAsICO(canvas);
                    break;
            }
        }).catch(function(error) {
            console.error("Error en html2canvas:", error);
            showNotification('Error con html2canvas, usando método alternativo', 'warning');
            exportDirectly();
        });
    }, 300); // Retraso mayor para asegurar que todo esté renderizado
}

// Exportar como PNG usando dataURL
function exportAsPNG(canvas) {
    try {
        const dataURL = canvas.toDataURL('image/png');
        downloadURI(dataURL, 'logo-wil.png');
        showNotification('Logo exportado como PNG', 'success');
    } catch (error) {
        console.error("Error al exportar PNG:", error);
        showNotification('Error al exportar PNG: ' + error.message, 'error');
    }
}

// Exportar como PNG directamente
function exportAsPNGDirect(canvas) {
    try {
        const dataURL = canvas.toDataURL('image/png');
        downloadURI(dataURL, 'logo-wil.png');
        showNotification('Logo exportado como PNG (método directo)', 'success');
    } catch (error) {
        console.error("Error al exportar PNG:", error);
        showNotification('Error al exportar PNG: ' + error.message, 'error');
    }
}

// Función auxiliar para descargar URI
function downloadURI(uri, name) {
    const link = document.createElement('a');
    link.download = name;
    link.href = uri;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}

// Exportar como SVG usando texto normal
function exportAsSVG() {
    try {
        // Crear un contenedor SVG
        const svgNamespace = "http://www.w3.org/2000/svg";
        const svg = document.createElementNS(svgNamespace, "svg");
        
        // Obtener dimensiones del logo
        const logoCanvas = document.getElementById('logo-canvas');
        const width = logoCanvas.offsetWidth || 300;
        const height = logoCanvas.offsetHeight || 300;
        
        // Configurar SVG
        svg.setAttribute("width", width);
        svg.setAttribute("height", height);
        svg.setAttribute("viewBox", `0 0 ${width} ${height}`);
        svg.setAttribute("xmlns", svgNamespace);
        
        // Obtener estilos computados
        const bgStyle = window.getComputedStyle(document.getElementById('background-shape'));
        const textStyle = window.getComputedStyle(document.getElementById('logo-text-element'));
        
        // Añadir fondo
        const background = document.createElementNS(svgNamespace, "rect");
        background.setAttribute("width", width);
        background.setAttribute("height", height);
        background.setAttribute("fill", bgStyle.backgroundColor || "#ffffff");
        
        // Aplicar border-radius si existe
        if (bgStyle.borderRadius && bgStyle.borderRadius !== '0px') {
            const borderRadius = bgStyle.borderRadius.replace('px', '');
            background.setAttribute("rx", borderRadius);
            background.setAttribute("ry", borderRadius);
        }
        
        svg.appendChild(background);
        
        // Añadir texto
        const text = document.createElementNS(svgNamespace, "text");
        
        // Obtener posición del texto
        let textX = width / 2;
        let textY = height / 2;
        
        // Si el texto tiene posición específica, usarla
        if (textStyle.left !== '50%' && !textStyle.left.includes('%')) {
            textX = parseFloat(textStyle.left) + parseFloat(textStyle.width) / 2;
        }
        if (textStyle.top !== '50%' && !textStyle.top.includes('%')) {
            textY = parseFloat(textStyle.top) + parseFloat(textStyle.height) / 2;
        }
        
        text.setAttribute("x", textX);
        text.setAttribute("y", textY);
        text.setAttribute("text-anchor", "middle");
        text.setAttribute("dominant-baseline", "middle");
        text.setAttribute("font-family", textStyle.fontFamily);
        text.setAttribute("font-size", textStyle.fontSize);
        text.setAttribute("font-weight", textStyle.fontWeight);
        text.setAttribute("fill", textStyle.color);
        
        // Añadir el contenido del texto
        const textNode = document.createTextNode(document.getElementById('logo-text-element').textContent);
        text.appendChild(textNode);
        
        svg.appendChild(text);
        
        // Convertir a string
        const serializer = new XMLSerializer();
        let svgString = serializer.serializeToString(svg);
        
        // Crear URL de datos
        const svgBlob = new Blob([svgString], {type: "image/svg+xml;charset=utf-8"});
        const svgUrl = URL.createObjectURL(svgBlob);
        
        downloadURI(svgUrl, 'logo-wil.svg');
        
        // Limpiar URL
        setTimeout(function() {
            URL.revokeObjectURL(svgUrl);
        }, 100);
        
        showNotification('Logo exportado como SVG', 'success');
    } catch (error) {
        console.error("Error al exportar SVG:", error);
        showNotification('Error al exportar SVG: ' + error.message, 'error');
    }
}

// Exportar como PDF
function exportAsPDF(canvas) {
    try {
        // Verificar si jsPDF está disponible
        if (typeof jspdf === 'undefined') {
            showNotification('Cargando biblioteca PDF...', 'info');
            
            // Cargar jsPDF si no está disponible
            const script = document.createElement('script');
            script.src = 'https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js';
            script.onload = function() {
                exportAsPDF(canvas);
            };
            document.head.appendChild(script);
            return;
        }
        
        // Usar dataURL directamente
        const imgData = canvas.toDataURL('image/png');
        
        // Crear nuevo documento PDF con formato A4
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF({
            orientation: 'portrait',
            unit: 'mm',
            format: 'a4'
        });
        
        // Dimensiones de A4 en mm
        const pdfWidth = 210;
        const pdfHeight = 297;
        
        // Calcular dimensiones para mantener proporción
        const maxWidth = pdfWidth * 0.7;
        const maxHeight = pdfHeight * 0.7;
        
        const imgRatio = canvas.width / canvas.height;
        let imgWidth, imgHeight;
        
        if (canvas.width > canvas.height) {
            // Imagen horizontal
            imgWidth = Math.min(maxWidth, canvas.width);
            imgHeight = imgWidth / imgRatio;
        } else {
            // Imagen vertical
            imgHeight = Math.min(maxHeight, canvas.height);
            imgWidth = imgHeight * imgRatio;
        }
        
        // Centrar en la página
        const x = (pdfWidth - imgWidth) / 2;
        const y = (pdfHeight - imgHeight) / 2;
        
        // Añadir imagen al PDF
        pdf.addImage(imgData, 'PNG', x, y, imgWidth, imgHeight);
        
        // Guardar PDF
        pdf.save('logo-wil.pdf');
        
        showNotification('Logo exportado como PDF', 'success');
    } catch (error) {
        console.error("Error al exportar PDF:", error);
        showNotification('Error al exportar PDF: ' + error.message, 'error');
    }
}

// Exportar como PDF directamente
function exportAsPDFDirect(canvas) {
    try {
        // Verificar si jsPDF está disponible
        if (typeof jspdf === 'undefined') {
            showNotification('Cargando biblioteca PDF...', 'info');
            
            // Cargar jsPDF si no está disponible
            const script = document.createElement('script');
            script.src = 'https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js';
            script.onload = function() {
                exportAsPDFDirect(canvas);
            };
            document.head.appendChild(script);
            return;
        }
        
        // Usar dataURL directamente
        const imgData = canvas.toDataURL('image/png');
        
        // Crear nuevo documento PDF con formato A4
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF({
            orientation: 'portrait',
            unit: 'mm',
            format: 'a4'
        });
        
        // Dimensiones de A4 en mm
        const pdfWidth = 210;
        const pdfHeight = 297;
        
        // Calcular dimensiones para mantener proporción
        const maxWidth = pdfWidth * 0.7;
        const maxHeight = pdfHeight * 0.7;
        
        const imgRatio = canvas.width / canvas.height;
        let imgWidth, imgHeight;
        
        if (canvas.width > canvas.height) {
            // Imagen horizontal
            imgWidth = Math.min(maxWidth, canvas.width);
            imgHeight = imgWidth / imgRatio;
        } else {
            // Imagen vertical
            imgHeight = Math.min(maxHeight, canvas.height);
            imgWidth = imgHeight * imgRatio;
        }
        
        // Centrar en la página
        const x = (pdfWidth - imgWidth) / 2;
        const y = (pdfHeight - imgHeight) / 2;
        
        // Añadir imagen al PDF
        pdf.addImage(imgData, 'PNG', x, y, imgWidth, imgHeight);
        
        // Guardar PDF
        pdf.save('logo-wil.pdf');
        
        showNotification('Logo exportado como PDF (método directo)', 'success');
    } catch (error) {
        console.error("Error al exportar PDF:", error);
        showNotification('Error al exportar PDF: ' + error.message, 'error');
    }
}

// Exportar como ICO
function exportAsICO(canvas) {
    try {
        // Verificar que el canvas tenga dimensiones válidas
        if (canvas.width === 0 || canvas.height === 0) {
            throw new Error('El canvas tiene dimensiones inválidas');
        }
        
        // Crear un canvas de 32x32 para favicon
        const faviconCanvas = document.createElement('canvas');
        faviconCanvas.width = 32;
        faviconCanvas.height = 32;
        const ctx = faviconCanvas.getContext('2d');
        
        // Fondo blanco para transparencia
        ctx.fillStyle = 'white';
        ctx.fillRect(0, 0, 32, 32);
        
        // Dibujar el logo redimensionado
        ctx.drawImage(canvas, 0, 0, 32, 32);
        
        // Usar dataURL para descargar
        const dataURL = faviconCanvas.toDataURL('image/png');
        downloadURI(dataURL, 'favicon.ico');
        
        showNotification('Logo exportado como ICO', 'success');
    } catch (error) {
        console.error("Error al exportar ICO:", error);
        showNotification('Error al exportar ICO: ' + error.message, 'error');
    }
}

// Exportar como ICO directamente
function exportAsICODirect(canvas) {
    try {
        // Crear un canvas de 32x32 para favicon
        const faviconCanvas = document.createElement('canvas');
        faviconCanvas.width = 32;
        faviconCanvas.height = 32;
        const ctx = faviconCanvas.getContext('2d');
        
        // Fondo blanco para transparencia
        ctx.fillStyle = 'white';
        ctx.fillRect(0, 0, 32, 32);
        
        // Dibujar el logo redimensionado
        ctx.drawImage(canvas, 0, 0, 32, 32);
        
        // Usar dataURL para descargar
        const dataURL = faviconCanvas.toDataURL('image/png');
        downloadURI(dataURL, 'favicon.ico');
        
        showNotification('Logo exportado como ICO (método directo)', 'success');
    } catch (error) {
        console.error("Error al exportar ICO:", error);
        showNotification('Error al exportar ICO: ' + error.message, 'error');
    }
}

// Exportar para redes sociales
function exportForSocialMedia(network) {
    let width, height;
    let filename;
    
    switch(network) {
        case 'facebook':
            width = 1200;
            height = 630;
            filename = 'logo-facebook.png';
            break;
        case 'twitter':
            width = 1500;
            height = 500;
            filename = 'logo-twitter.png';
            break;
        case 'instagram':
            width = 1080;
            height = 1080;
            filename = 'logo-instagram.png';
            break;
        case 'linkedin':
            width = 1584;
            height = 396;
            filename = 'logo-linkedin.png';
            break;
        default:
            width = 1200;
            height = 630;
            filename = 'logo-social.png';
    }
    
    // Ocultar temporalmente los controles de redimensionamiento
    $('.resize-handle').hide();
    
    // Obtener el elemento DOM directamente
    const logoCanvas = document.getElementById('logo-canvas');
    
    // Método alternativo para redes sociales
    function exportSocialDirectly() {
        try {
            // Crear un canvas manualmente
            const canvas = document.createElement('canvas');
            const logoWidth = logoCanvas.offsetWidth || 300;
            const logoHeight = logoCanvas.offsetHeight || 300;
            
            // Crear un canvas para redes sociales
            const socialCanvas = document.createElement('canvas');
            socialCanvas.width = width;
            socialCanvas.height = height;
            const ctx = socialCanvas.getContext('2d');
            
            // Fondo blanco
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, width, height);
            
            // Dibujar logo
            const bgElement = document.getElementById('background-shape');
            const bgStyle = window.getComputedStyle(bgElement);
            
            // Calcular dimensiones para mantener proporción
            const ratio = Math.min(width / logoWidth, height / logoHeight) * 0.5;
            const imgWidth = logoWidth * ratio;
            const imgHeight = logoHeight * ratio;
            
            // Centrar en el canvas
            const x = (width - imgWidth) / 2;
            const y = (height - imgHeight) / 2;
            
            // Dibujar fondo del logo
            ctx.fillStyle = bgStyle.backgroundColor || '#ffffff';
            
            // Dibujar rectángulo con border-radius si es necesario
            const borderRadius = parseInt(bgStyle.borderRadius) || 0;
            
            if (borderRadius > 0) {
                // Dibujar rectángulo con esquinas redondeadas
                ctx.beginPath();
                ctx.moveTo(x + borderRadius, y);
                ctx.lineTo(x + imgWidth - borderRadius, y);
                ctx.quadraticCurveTo(x + imgWidth, y, x + imgWidth, y + borderRadius);
                ctx.lineTo(x + imgWidth, y + imgHeight - borderRadius);
                ctx.quadraticCurveTo(x + imgWidth, y + imgHeight, x + imgWidth - borderRadius, y + imgHeight);
                ctx.lineTo(x + borderRadius, y + imgHeight);
                ctx.quadraticCurveTo(x, y + imgHeight, x, y + imgHeight - borderRadius);
                ctx.lineTo(x, y + borderRadius);
                ctx.quadraticCurveTo(x, y, x + borderRadius, y);
                ctx.closePath();
                ctx.fill();
            } else {
                // Rectángulo simple
                ctx.fillRect(x, y, imgWidth, imgHeight);
            }
            
            // Dibujar texto
            const textElement = document.getElementById('logo-text-element');
            const textStyle = window.getComputedStyle(textElement);
            const text = textElement.textContent || 'WS';
            
            ctx.fillStyle = textStyle.color || '#000000';
            ctx.font = `${textStyle.fontWeight} ${parseInt(textStyle.fontSize) * ratio}px ${textStyle.fontFamily}`;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            
            // Posición del texto
            ctx.fillText(text, width / 2, height / 2);
            
            // Usar dataURL para descargar
            const dataURL = socialCanvas.toDataURL('image/png');
            downloadURI(dataURL, filename);
            
            // Restaurar controles
            $('.resize-handle').show();
            
            showNotification('Logo exportado para ' + network + ' (método directo)', 'success');
        } catch (error) {
            console.error("Error en exportación directa para redes sociales:", error);
            showNotification('Error al exportar: ' + error.message, 'error');
            $('.resize-handle').show();
        }
    }
    
    // Intentar primero con html2canvas
    html2canvas(logoCanvas, {
        backgroundColor: null,
        useCORS: true,
        allowTaint: true,
        scale: 2,
        onclone: function(clonedDoc) {
            // Asegurar que el clon tenga estilos correctos
            const clonedCanvas = clonedDoc.getElementById('logo-canvas');
            if (clonedCanvas) {
                clonedCanvas.style.width = logoCanvas.offsetWidth + 'px';
                clonedCanvas.style.height = logoCanvas.offsetHeight + 'px';
                clonedCanvas.style.display = 'block';
                clonedCanvas.style.visibility = 'visible';
            }
        }
    }).then(function(canvas) {
        // Verificar que el canvas tenga dimensiones válidas
        if (canvas.width === 0 || canvas.height === 0) {
            console.warn('html2canvas generó un canvas con dimensiones inválidas, usando método alternativo');
            exportSocialDirectly();
            return;
        }
        
        // Crear un nuevo canvas con las dimensiones para redes sociales
        const socialCanvas = document.createElement('canvas');
        socialCanvas.width = width;
        socialCanvas.height = height;
        const ctx = socialCanvas.getContext('2d');
        
        // Fondo blanco
        ctx.fillStyle = '#ffffff';
        ctx.fillRect(0, 0, width, height);
        
        // Calcular dimensiones para mantener proporción
        const ratio = Math.min(width / canvas.width, height / canvas.height) * 0.8;
        const imgWidth = canvas.width * ratio;
        const imgHeight = canvas.height * ratio;
        
        // Centrar en el canvas
        const x = (width - imgWidth) / 2;
        const y = (height - imgHeight) / 2;
        
        // Dibujar el logo
        ctx.drawImage(canvas, x, y, imgWidth, imgHeight);
        
        // Usar dataURL para descargar
        const dataURL = socialCanvas.toDataURL('image/png');
        downloadURI(dataURL, filename);
        
        // Restaurar controles
        $('.resize-handle').show();
        
        showNotification('Logo exportado para ' + network, 'success');
    }).catch(function(error) {
        console.error("Error al exportar para redes sociales:", error);
        showNotification('Error con html2canvas, usando método alternativo', 'warning');
        exportSocialDirectly();
    });
}

// ===============================================
// PARTE 11: HISTORIAL, VISTA PREVIA Y UTILIDADES
// ===============================================

// Variables para el historial
let history = [];
let currentState = -1;
const MAX_HISTORY = 20;

// Guardar el estado actual en el historial
function saveState() {
    // Capturar el estado actual del logo
    const logoCanvas = $('#logo-canvas');
    const state = {
        canvas: {
            width: logoCanvas.css('width'),
            height: logoCanvas.css('height')
        },
        elements: {}
    };
    
    // Capturar estado de cada elemento
    $('.logo-element').each(function() {
        const id = $(this).attr('id');
        state.elements[id] = {
            html: $(this).prop('outerHTML'),
            css: {
                position: $(this).css('position'),
                top: $(this).css('top'),
                left: $(this).css('left'),
                width: $(this).css('width'),
                height: $(this).css('height'),
                backgroundColor: $(this).css('background-color'),
                background: $(this).css('background'),
                borderRadius: $(this).css('border-radius'),
                color: $(this).css('color'),
                fontFamily: $(this).css('font-family'),
                fontSize: $(this).css('font-size'),
                fontWeight: $(this).css('font-weight'),
                textShadow: $(this).css('text-shadow'),
                zIndex: $(this).css('z-index'),
                transform: $(this).css('transform')
            },
            text: $(this).text()
        };
    });
    
    // Si estamos en medio del historial, eliminar estados futuros
    if (currentState < history.length - 1) {
        history = history.slice(0, currentState + 1);
    }
    
    // Añadir nuevo estado y mantener límite de historial
    history.push(state);
    if (history.length > MAX_HISTORY) {
        history.shift();
    }
    
    currentState = history.length - 1;
    
    // Actualizar estado de botones de deshacer/rehacer
    updateUndoRedoButtons();
    
    // Actualizar miniaturas de historial (simplificado)
    updateHistoryThumbnails();
}

// Deshacer la última acción
function undoAction() {
    if (currentState > 0) {
        currentState--;
        restoreState(history[currentState]);
        updateUndoRedoButtons();
    }
}

// Rehacer la acción deshecha
function redoAction() {
    if (currentState < history.length - 1) {
        currentState++;
        restoreState(history[currentState]);
        updateUndoRedoButtons();
    }
}

// Restaurar un estado guardado
function restoreState(state) {
    // Restaurar dimensiones del canvas
    $('#logo-canvas').css({
        'width': state.canvas.width,
        'height': state.canvas.height
    });
    
    // Limpiar el canvas
    $('#logo-canvas').empty();
    
    // Restaurar elementos
    for (const id in state.elements) {
        const elementState = state.elements[id];
        
        // Recrear el elemento
        $('#logo-canvas').append(elementState.html);
        
        // Restaurar propiedades
        $('#' + id).css(elementState.css).text(elementState.text);
        
        // Reconfigurar eventos
        if (id.startsWith('text-') || id === 'logo-text-element') {
            makeElementDraggable(id);
        } else if (id.startsWith('shape-') || id.startsWith('image-')) {
            makeElementDraggable(id);
            makeElementResizable(id);
        }
    }
    
    // Actualizar miniaturas de historial
    updateHistoryThumbnails();
}

// Actualizar estado de botones de deshacer/rehacer
function updateUndoRedoButtons() {
    $('#btn-undo').prop('disabled', currentState <= 0);
    $('#btn-redo').prop('disabled', currentState >= history.length - 1);
}

// Actualizar miniaturas de historial
function updateHistoryThumbnails() {
    // Esta función podría implementarse para mostrar miniaturas del historial
    // Simplificada para este ejemplo
}

// Actualizar vista previa en tiempo real
function updatePreview() {
    // Esta función se llama cuando cambia algo en el logo
    // Ya está implementada a través de las funciones individuales
}

// Actualizar pestaña de vista previa
function updatePreviewTab() {
    // Clonar el canvas para la vista previa
    const previewCanvas = $('#preview-canvas');
    previewCanvas.empty();
    
    // Clonar elementos
    $('#logo-canvas').children().clone().appendTo(previewCanvas);
    
    // Aplicar fondo seleccionado
    changePreviewBackground($('.preview-bg-option.active').data('bg') || 'white');
}

// Mostrar modal de vista previa
function showPreviewModal() {
    // Clonar el canvas para la vista previa modal
    const modalCanvas = $('#modal-preview-canvas');
    modalCanvas.empty();
    
    // Clonar elementos
    $('#logo-canvas').children().clone().appendTo(modalCanvas);
    
    // Mostrar modal
    $('#preview-modal').css('display', 'flex');
}

// Cambiar fondo de vista previa
function changePreviewBackground(bgType) {
    const previewBg = $('#preview-background');
    
    switch(bgType) {
        case 'white':
            previewBg.css('background', 'white');
            break;
        case 'black':
            previewBg.css('background', 'black');
            break;
        case 'pattern':
            previewBg.css({
                'background-image': 'linear-gradient(45deg, #ccc 25%, transparent 25%), linear-gradient(-45deg, #ccc 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ccc 75%), linear-gradient(-45deg, transparent 75%, #ccc 75%)',
                'background-size': '20px 20px',
                'background-position': '0 0, 0 10px, 10px -10px, -10px 0px'
            });
            break;
        case 'gradient':
            previewBg.css('background', 'linear-gradient(45deg, #f3f3f3, #e1e1e1)');
            break;
    }
}

// Cambiar dispositivo de vista previa
function changePreviewDevice(device) {
    const previewCanvas = $('#preview-canvas');
    
    switch(device) {
        case 'desktop':
            previewCanvas.css({
                'width': '100%',
                'height': '100%',
                'transform': 'none'
            });
            break;
        case 'tablet':
            previewCanvas.css({
                'width': '768px',
                'height': '1024px',
                'transform': 'scale(0.5)',
                'transform-origin': 'center top'
            });
            break;
        case 'mobile':
            previewCanvas.css({
                'width': '375px',
                'height': '667px',
                'transform': 'scale(0.5)',
                'transform-origin': 'center top'
            });
            break;
    }
}

// Mostrar/ocultar cuadrícula
function toggleGrid() {
    $('.canvas-bg').toggleClass('grid-visible');
    $('#btn-grid').toggleClass('active');
}

// Generar ID único
function generateUniqueId() {
    return Date.now().toString(36) + Math.random().toString(36).substr(2, 5);
}

// Mostrar notificación
function showNotification(message, type) {
    // Verificar si ya existe un contenedor de notificaciones
    let notificationContainer = $('#notification-container');
    
    if (notificationContainer.length === 0) {
        notificationContainer = $('<div id="notification-container"></div>');
        notificationContainer.css({
            'position': 'fixed',
            'bottom': '20px',
            'right': '20px',
            'z-index': '9999'
        });
        $('body').append(notificationContainer);
    }
    
    // Crear notificación
    const notification = $('<div class="notification"></div>');
    notification.css({
        'background': type === 'error' ? '#e74c3c' : 
                      type === 'success' ? '#2ecc71' : 
                      type === 'warning' ? '#f39c12' : '#1978d7',
        'color': 'white',
        'padding': '12px 20px',
        'margin-top': '10px',
        'border-radius': '4px',
        'box-shadow': '0 2px 10px rgba(0,0,0,0.2)',
        'opacity': '0',
        'transform': 'translateY(20px)',
        'transition': 'all 0.3s ease'
    });
    
    notification.text(message);
    
    // Añadir al contenedor
    notificationContainer.append(notification);
    
    // Animar entrada
    setTimeout(function() {
        notification.css({
            'opacity': '1',
            'transform': 'translateY(0)'
        });
    }, 10);
    
    // Animar salida y eliminar
    setTimeout(function() {
        notification.css({
            'opacity': '0',
            'transform': 'translateY(-20px)'
        });
        
        setTimeout(function() {
            notification.remove();
        }, 300);
    }, 3000);
}

// Convertir RGB a Hex
function rgbToHex(rgb) {
    // Extraer valores RGB
    const match = rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
    if (!match) return rgb; // Si ya es hex o formato no reconocido
    
    function hex(x) {
        return ("0" + parseInt(x).toString(16)).slice(-2);
    }
    
    return "#" + hex(match[1]) + hex(match[2]) + hex(match[3]);
}

// Convertir Hex a RGB
function hexToRgb(hex) {
    // Expandir formato abreviado
    const shorthandRegex = /^#?([a-f\d])([a-f\d])([a-f\d])$/i;
    hex = hex.replace(shorthandRegex, function(m, r, g, b) {
        return r + r + g + g + b + b;
    });
    
    const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
    return result ? 
        'rgb(' + parseInt(result[1], 16) + ', ' + 
                 parseInt(result[2], 16) + ', ' + 
                 parseInt(result[3], 16) + ')' : null;
}
</script>

</body>
</html>